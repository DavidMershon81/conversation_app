(this.webpackJsonppetition_app=this.webpackJsonppetition_app||[]).push([[0],{38:function(e,t,r){},39:function(e,t,r){},68:function(e,t,r){"use strict";r.r(t);var s=r(1),n=r.n(s),i=r(32),a=r.n(i),o=(r(38),r(2)),c=(r(39),r(6)),l=r(3),j=r(16),u=r.n(j),b=function(e){var t=e.url,r=e.params,n=Object(s.useState)(null),i=Object(o.a)(n,2),a=i[0],c=i[1],l=Object(s.useState)(!0),j=Object(o.a)(l,2),b=j[0],d=j[1],m=Object(s.useState)(!1),p=Object(o.a)(m,2),g=p[0],O=p[1],x=Object(s.useState)(""),h=Object(o.a)(x,2),_=h[0],v=h[1],f=Object(s.useRef)(!0),N=function(e){f.current&&(d(!1),O(!0),v(e.response.data.message))},S=Object(s.useCallback)((function(){f.current&&(d(!0),O(!1),v("")),u.a.get(t,{params:r}).then((function(e){f.current&&(c(e.data),d(!1))}),N)}),[t,r]);return Object(s.useEffect)((function(){return S(),function(){f.current=!1}}),[S]),{data:a,getData:S,loading:b,error:g,errorMessage:_}},d=r(0),m=function(e){var t=e.id,r=e.text,s=e.onBtnClick,n=e.className;return Object(d.jsx)("button",{className:n,type:"button",onClick:function(){s(t,r)},children:r})},p=function(e){var t=e.loading,r=e.error,s=e.errorMessage;return Object(d.jsx)(d.Fragment,{children:(t||r)&&Object(d.jsxs)("div",{className:"loading_box",children:[t&&Object(d.jsx)("p",{children:"Loading..."}),r&&Object(d.jsxs)("p",{children:["error: ",s]})]})})},g=function(){var e=b({url:"/api/users"}),t=e.data,r=e.loading,s=e.error,n=e.errorMessage;return Object(d.jsxs)("section",{children:[Object(d.jsx)("h2",{children:"Users (Debug View)"}),Object(d.jsx)("p",{children:"This page shows all of the users in the app."}),Object(d.jsx)(p,{loading:r,error:s,errorMessage:n}),Object(d.jsx)("ul",{className:"users_list_group",children:t&&t.map((function(e){return Object(d.jsxs)("li",{className:"users_list_item",children:["id:",e.id," | ",e.email,Object(d.jsx)("br",{}),e.first_name," ",e.last_name]},e.id)}))})]})},O=Object(s.createContext)({}),x=function(e){var t=e.petitionGroupId,r=Object(s.useRef)({petition_group_id:t}),n=b({url:"/api/petitions",params:r.current}),i=n.data,a=n.loading,o=n.error,l=n.errorMessage;return Object(d.jsxs)("section",{className:"petition_group_section",children:[Object(d.jsx)("strong",{children:"Petitions"}),Object(d.jsx)(p,{loading:a,error:o,errorMessage:l}),Object(d.jsx)("ul",{className:"petitions_list_group",children:i&&i.length>0?i.map((function(e,t){return Object(d.jsxs)("li",{className:"petitions_list_item",children:[Object(d.jsx)(c.b,{className:"petitions_list_btn",to:"/petitions/".concat(e.id),children:"View"}),Object(d.jsxs)("span",{children:["Subject: ",e.subject]})]},t)})):Object(d.jsx)("p",{children:"This group has no petition yet."})}),i&&Object(d.jsx)("div",{className:"add_petition_group_btn",children:Object(d.jsx)(c.b,{className:"add_petition_btn_text",to:"/add_petition/".concat(t),children:"Add New Petition"})})]})},h=function(e){var t=e.petitionGroupId,r=Object(s.useRef)({petition_group_id:t}),n=b({url:"/api/members",params:r.current}),i=n.data,a=n.loading,c=n.error,l=n.errorMessage,j=Object(s.useState)(!1),u=Object(o.a)(j,2),g=u[0],O=u[1],x=g?"Hide":"Show";return Object(d.jsxs)("section",{className:"petition_group_section",children:[Object(d.jsx)("strong",{children:"Members"}),Object(d.jsx)(m,{className:"full_width_btn",onBtnClick:function(e,t){O(!g)},text:x}),Object(d.jsx)(p,{loading:a,error:c,errorMessage:l}),g&&Object(d.jsx)("ul",{className:"users_list_group",children:i&&i.length>0?i.map((function(e){return Object(d.jsx)("li",{className:"users_list_item",children:e.email},e.email)})):Object(d.jsx)("p",{children:"This group has no members yet."})})]})},_=function(e){var t=e.petitionGroup;return Object(d.jsxs)("p",{children:[Object(d.jsx)("strong",{children:"id:"})," ",t.id,Object(d.jsx)("br",{}),Object(d.jsx)("strong",{children:"listserv_email:"})," ",t.listserv_email,Object(d.jsx)("br",{})]})},v=function(e){var t=e.basePath,r=Object(s.useContext)(O).loggedInUser,n=Object(l.g)().pathname.replace(t,""),i=b({url:"/api/petition_groups/".concat(n)}),a=i.data,o=i.loading,c=i.error,j=i.errorMessage;return r?Object(d.jsxs)("section",{className:"petition_group_view",children:[Object(d.jsx)(p,{loading:o,error:c,errorMessage:j}),a&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("h2",{children:["Petition Group: ",a.group_name]}),Object(d.jsx)(_,{petitionGroup:a}),Object(d.jsx)(h,{petitionGroupId:n}),Object(d.jsx)(x,{petitionGroupId:a.id})]})]}):Object(d.jsx)(l.a,{to:"/login"})},f=function(e){var t=e.url,r=e.authToken,n=e.onConfirm,i=e.confirmText,a=Object(s.useState)(!1),c=Object(o.a)(a,2),l=c[0],j=c[1],b=Object(s.useState)(!1),d=Object(o.a)(b,2),m=d[0],p=d[1],g=Object(s.useState)(""),O=Object(o.a)(g,2),x=O[0],h=O[1],_=Object(s.useState)(""),v=Object(o.a)(_,2),f=v[0],N=v[1],S=Object(s.useState)(null),M=Object(o.a)(S,2),y=M[0],w=M[1],C=function(e){j(!1),p(!0),h(e.response.data.message)};return{post:function(e){j(!0),p(!1),h(""),N(""),w(null);var s={headers:{Authorization:r}};u.a.post(t,e,s).then((function(e){j(!1),w(e.data),N(i),n&&n()}),C)},responseData:y,loading:l,error:m,confirmMessage:f,errorMessage:x}},N=r(7),S=r(12),M=r(17),y=Object(s.createContext)({}),w=function(e){var t=e.varName,r=e.visibleName,n=e.validateErrorMessage,i=Object(s.useContext)(y).errors,a=null!=i[t],o=a&&"required"===i[t].type,c=a&&"validate"===i[t].type;if(o||c){var l=c?n:"".concat(r," required!");return Object(d.jsx)("span",{className:"form_error_message",children:l})}return Object(d.jsx)("span",{})},C=function(e){var t=e.varName,r=e.visibleName,n=e.type,i=e.validateFunction,a=void 0===i?function(){return!0}:i,o=e.validateErrorMessage,c=Object(s.useContext)(y).register,l={required:!0,validate:a};return Object(d.jsxs)(d.Fragment,{children:["textarea"===n?Object(d.jsx)("textarea",Object(M.a)({rows:"10",className:"form_text_area",placeholder:r},c(t,l))):Object(d.jsx)("input",Object(M.a)({className:"form_text_input",type:n,placeholder:r},c(t,l))),Object(d.jsx)(w,{varName:t,visibleName:r,validateErrorMessage:o})]})},P=function(e){var t=e.varName,r=e.valueName,n=e.valueText,i=e.onClick,a=Object(s.useContext)(y).register;return Object(d.jsxs)("label",{className:"form_checkbox_container",children:[Object(d.jsx)("input",Object(M.a)(Object(M.a)({},a(t,{required:!0})),{},{type:"radio",value:r,onClick:function(){i(r)}})),n,Object(d.jsx)("span",{className:"checkmark"})]})},k=function(e){var t=e.varName,r=e.visibleName,s=e.buttonsConfig,n=e.onClick;return Object(d.jsxs)("fieldset",{className:"form_radio_button_set",children:[s.map((function(e){var r=e.valueName,s=e.valueText;return Object(d.jsx)(P,{varName:t,valueName:r,valueText:s,onClick:n},r)})),Object(d.jsx)(w,{varName:t,visibleName:r})]})},I=function(e){var t=e.varName,r=e.varValue,n=Object(s.useContext)(y).register;return Object(d.jsx)("input",Object(M.a)({type:"hidden",value:r},n(t)))},T=function(e){var t=e.onBtnClick;return Object(d.jsx)(k,{varName:"email_type",visibleName:"email notification type",buttonsConfig:[{valueName:"listserv",valueText:"Send petition to a single mailing list"},{valueName:"custom_emails",valueText:"Send petition to a list of email addresses"}],onClick:t})},U=function(){var e=Object(s.useContext)(y),t=e.unregister,r=e.watch,n=Object(s.useState)([]),i=Object(o.a)(n,2),a=i[0],c=i[1],l=r("email_type"),j=function(){var e="custom_email_".concat(a.length);c([].concat(Object(N.a)(a),[e]))};return Object(d.jsxs)("fieldset",{className:"notification_emails_section",children:[Object(d.jsx)(T,{onBtnClick:function(e){"listserv"===e?(t(a),c([])):"custom_emails"===e&&(t(["listserv_email"]),a.length<1&&j())}}),"custom_emails"===l&&Object(d.jsxs)("fieldset",{className:"notification_emails_section",children:[a.map((function(e){return Object(d.jsx)(C,{type:"email",varName:e,visibleName:e},e)})),Object(d.jsx)("input",{className:"add_email_button",type:"button",onClick:j,value:"Add Another Email"})]}),"listserv"===l&&Object(d.jsx)("fieldset",{className:"notification_emails_section",children:Object(d.jsx)(C,{type:"email",varName:"listserv_email",visibleName:"mailing list email"})})]})},A=function(e){var t=e.onSubmit,r=Object(S.a)(),s=r.register,n=r.unregister,i=r.handleSubmit,a=r.formState.errors,o=r.watch;return Object(d.jsxs)("form",{className:"input_form",onSubmit:i((function(e){console.log(e),t(e)})),children:[Object(d.jsxs)(y.Provider,{value:{register:s,unregister:n,watch:o,errors:a},children:[Object(d.jsx)(C,{type:"text",varName:"group_name",visibleName:"group name"}),Object(d.jsx)(U,{})]}),Object(d.jsx)("input",{className:"form_submit_btn",type:"submit",value:"Create New Petition Group"})]})},L=function(){var e=Object(s.useContext)(O).loggedInUser,t=f({url:"/api/petition_groups",confirmText:"Added Petition Group"}),r=t.post,n=t.confirmMessage,i=t.loading,a=t.error,o=t.errorMessage;return e?Object(d.jsxs)("section",{children:[Object(d.jsx)("h2",{children:"Add Petition Group"}),Object(d.jsx)("p",{children:"Use this form to add a new petition group."}),Object(d.jsx)(A,{onSubmit:r}),n&&Object(d.jsx)("p",{children:n}),Object(d.jsx)(p,{loading:i,error:a,errorMessage:o})]}):Object(d.jsx)(l.a,{to:"/login"})},G=function(e){var t=e.onSubmit,r=e.petitionGroupId,n=Object(s.useContext)(O).loggedInUser,i=Object(S.a)(),a=i.register,o=i.unregister,c=i.handleSubmit,j=i.formState.errors,u=i.watch;return n?Object(d.jsxs)("form",{className:"input_form",onSubmit:c((function(e){console.log(e),t(e)})),children:[Object(d.jsxs)(y.Provider,{value:{register:a,unregister:o,watch:u,errors:j},children:[Object(d.jsx)(C,{type:"text",varName:"subject",visibleName:"subject"}),Object(d.jsx)(C,{type:"textarea",varName:"petition_text",visibleName:"petition text"}),Object(d.jsx)(I,{varName:"petition_group_id",varValue:r})]}),Object(d.jsx)("input",{className:"form_submit_btn",type:"submit",value:"Add New Petition"})]}):Object(d.jsx)(l.a,{to:"/login"})},F=function(e){var t=e.basePath,r=Object(l.g)().pathname.replace(t,""),s=f({url:"/api/petitions",confirmText:"Added New Petition"}),n=s.post,i=s.confirmMessage,a=s.loading,o=s.error,c=s.errorMessage;return Object(d.jsxs)("section",{children:[Object(d.jsx)("h2",{children:"Add Petition"}),Object(d.jsx)("p",{children:"Use this form to add a new petition."}),Object(d.jsx)(G,{petitionGroupId:r,onSubmit:n}),i&&Object(d.jsx)("p",{children:i}),Object(d.jsx)(p,{loading:a,error:o,errorMessage:c})]})},E=function(e){var t=e.onSubmit,r=e.petition,s=Object(S.a)(),n=s.register,i=s.unregister,a=s.handleSubmit,o=s.formState.errors,c=s.watch;return Object(d.jsxs)("form",{className:"input_form",onSubmit:a((function(e){t(e)})),children:[Object(d.jsxs)(y.Provider,{value:{register:n,unregister:i,watch:c,errors:o},children:[Object(d.jsx)(C,{type:"number",varName:"reveal_threshold",visibleName:"reveal threshold"}),Object(d.jsx)(I,{varName:"petition_id",varValue:r.id})]}),Object(d.jsx)("input",{className:"form_submit_btn",type:"submit",value:"Sign Petition"})]})},R=function(e){var t=e.petition,r=e.onConfirm,s=f({url:"/api/signatures",onConfirm:r,confirmText:"Submitted Signature"}),n=s.post,i=s.confirmMessage,a=s.loading,o=s.error,c=s.errorMessage;return Object(d.jsxs)("section",{className:"users_list_item test_signature_user_box",children:[Object(d.jsx)(E,{onSubmit:n,petition:t}),i&&Object(d.jsx)("p",{children:i}),Object(d.jsx)(p,{loading:a,error:o,errorMessage:c})]})},B=function(e){var t=e.petition,r=Object(s.useRef)({petition_id:t.id}),n=b({url:"/api/signatures",params:r.current}),i=n.data,a=n.getData,o=n.loading,c=n.error,l=n.errorMessage,j=b({url:"/api/user_signed",params:r.current}),u=j.data,m=j.getData,g=j.usLoading,O=j.usError,x=j.usErrorMessage,h=null!=u&&!u.user_signed;return Object(d.jsxs)("section",{children:[Object(d.jsx)(p,{loading:o,error:c,errorMessage:l}),Object(d.jsx)(p,{loading:g,error:O,errorMessage:x}),i&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h4",{children:"Revealed Signatures"}),Object(d.jsxs)("ul",{className:"test_signature_user_group",children:[i.revealed_signatures.length<1&&Object(d.jsx)("li",{children:"No signatures have been revealed"}),i.revealed_signatures.length>0&&i.revealed_signatures.map((function(e,t){return Object(d.jsx)("li",{className:"users_list_item test_signature_user_box",children:e},t)}))]}),Object(d.jsx)("h4",{children:"Unrevealed Signatures"}),Object(d.jsxs)("ul",{className:"test_signature_user_group",children:[i.unrevealed_signatures.length<1&&Object(d.jsx)("li",{children:"There are no unrevealed signatures"}),i.unrevealed_signatures.length>0&&i.unrevealed_signatures.map((function(e,t){return Object(d.jsxs)("li",{className:"users_list_item test_signature_user_box",children:["There are ",e.signatures," unrevealed signatures at threshold ",e.reveal_threshold]},t)}))]}),h?Object(d.jsx)(R,{petition:t,onConfirm:function(){a(),m()}}):Object(d.jsx)("p",{children:"You have already signed this petition."})]})]})},D=function(e){var t=e.basePath,r=Object(s.useContext)(O).loggedInUser,n=Object(l.g)().pathname.replace(t,""),i=b({url:"/api/petitions/".concat(n)}),a=i.data,o=i.loading,c=i.error,j=i.errorMessage;return r?Object(d.jsxs)("section",{children:[Object(d.jsx)(p,{loading:o,error:c,errorMessage:j}),a&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("h2",{children:["Petition: ",a.subject]}),Object(d.jsxs)("p",{children:["Petition Text: ",a.petition_text]}),Object(d.jsx)(B,{petition:a})]})]}):Object(d.jsx)(l.a,{to:"/login"})},V=function(e){var t=e.url,r=e.setLoggedInUser,n=Object(s.useState)(!0),i=Object(o.a)(n,2),a=i[0],c=i[1],l=Object(s.useState)(!1),j=Object(o.a)(l,2),b=j[0],d=j[1],m=Object(s.useState)(""),p=Object(o.a)(m,2),g=p[0],O=p[1],x=Object(s.useState)(!1),h=Object(o.a)(x,2),_=h[0],v=h[1];return{triedLogin:_,tryLogin:function(e,s){c(!0),d(!1),O(""),v(!0),u.a.get(t,{auth:{username:e,password:s}}).then((function(t){r(e),c(!1)}),(function(e){c(!1),d(!0),O(e.response.data.message)}))},loading:a,error:b,errorMessage:g}},q=function(e){var t=e.onSubmit,r=Object(S.a)(),s=r.register,n=r.handleSubmit,i=r.formState.errors;return Object(d.jsxs)("form",{className:"input_form",onSubmit:n((function(e){t(e)})),children:[Object(d.jsxs)(y.Provider,{value:{register:s,errors:i},children:[Object(d.jsx)(C,{type:"email",varName:"email",visibleName:"email"}),Object(d.jsx)(C,{type:"password",varName:"password",visibleName:"password"})]}),Object(d.jsx)("input",{className:"form_submit_btn",type:"submit",value:"Login"})]})},H=function(){var e=Object(s.useContext)(O),t=e.loggedInUser,r=e.setLoggedInUser,n=V({url:"/api/login",setLoggedInUser:r}),i=n.triedLogin,a=n.tryLogin,o=n.loading,j=n.error,u=n.errorMessage;return o&&i||!t?Object(d.jsxs)("section",{children:[Object(d.jsx)("h2",{children:"Login"}),!t&&Object(d.jsx)(q,{onSubmit:function(e){a(e.email,e.password)}}),i&&Object(d.jsx)(p,{loading:o,error:j,errorMessage:u}),t&&Object(d.jsx)("p",{children:"logged in."}),Object(d.jsxs)("p",{children:["Don't have an account yet?",Object(d.jsx)(c.b,{className:"inline_link",to:"/register",children:"Register A New Account"})]})]}):Object(d.jsx)(l.a,{to:"/"})},J=function(e){var t=e.onSubmit,r=Object(S.a)(),s=r.register,n=r.handleSubmit,i=r.formState.errors,a=r.getValues;return Object(d.jsxs)("form",{className:"input_form",onSubmit:n((function(e){t(e)})),children:[Object(d.jsxs)(y.Provider,{value:{register:s,errors:i},children:[Object(d.jsx)(C,{type:"email",varName:"email",visibleName:"email"}),Object(d.jsx)(C,{type:"password",varName:"password",visibleName:"password"}),Object(d.jsx)(C,{type:"password",varName:"confirm_password",visibleName:"confirm password",validateFunction:function(e){return a("password")===e},validateErrorMessage:"password doesn't match"}),Object(d.jsx)(C,{type:"text",varName:"first_name",visibleName:"first name"}),Object(d.jsx)(C,{type:"text",varName:"last_name",visibleName:"last name"})]}),Object(d.jsx)("input",{className:"form_submit_btn",type:"submit",value:"Register Account"})]})},W=function(){var e=f({url:"/api/users",onConfirm:function(){console.log("confirmed registration!")},confirmText:"Registered New Account!"}),t=e.post,r=e.confirmMessage,s=e.loading,n=e.error,i=e.errorMessage;return Object(d.jsxs)("section",{children:[Object(d.jsx)("h2",{children:"Register"}),Object(d.jsx)("p",{children:"Use this form to register a new account."}),Object(d.jsx)(J,{onSubmit:t}),r&&Object(d.jsx)("p",{children:r}),Object(d.jsx)(p,{loading:s,error:n,errorMessage:i})]})},Y=function(){var e=Object(s.useContext)(O).loggedInUser,t=b({url:"/api/petition_groups"}),r=t.data,n=t.loading,i=t.error,a=t.errorMessage;return e?Object(d.jsxs)("section",{children:[Object(d.jsx)("p",{children:"Welcome to the petition app!"}),r&&r.length>0&&Object(d.jsx)("p",{children:"Here are a list of the petition groups that you're a member of"}),r&&r.length<1&&Object(d.jsx)("p",{children:"You are not a member of any petition groups yet. Would you like to create one?"}),Object(d.jsx)("ul",{className:"petition_groups_list_group",children:r&&r.map((function(e){return Object(d.jsxs)("li",{className:"petition_groups_list_item",children:[Object(d.jsx)(c.b,{className:"petition_groups_list_btn",to:"/petition_group/".concat(e.id),children:"View"}),Object(d.jsx)("span",{children:e.group_name})]},e.id)}))}),r&&Object(d.jsx)("div",{className:"add_petition_group_btn",children:Object(d.jsx)(c.b,{className:"add_petition_group_text",to:"/add_petition_group",children:"Add New Petition Group"})}),Object(d.jsx)(p,{loading:n,error:i,errorMessage:a})]}):Object(d.jsx)(l.a,{to:"/login"})},z=function(){var e=Object(s.useContext)(O),t=e.loggedInUser,r=e.logout;return Object(d.jsxs)("section",{children:[Object(d.jsx)("h1",{className:"top_heading_text",children:"Petition App Prototype"}),Object(d.jsxs)("nav",{className:"top_nav",children:[Object(d.jsx)(c.b,{className:"nav_link",to:"/debug/users",children:"Users(debug)"}),t&&Object(d.jsx)(c.b,{className:"nav_link",to:"/",children:"Home"}),!t&&Object(d.jsx)(c.b,{className:"nav_link",to:"/login",children:"Login"}),t&&Object(d.jsx)(m,{className:"nav_link",onBtnClick:function(e,t){r()},text:"Logout"})]}),Object(d.jsx)("p",{className:"logged_in_user_text",children:t})]})},K=function(){var e=Object(s.useState)(null),t=Object(o.a)(e,2),r=t[0],n=t[1],i=b({url:"/api/get_current_user"}),a=i.data,j=i.loading,u=i.error,m=i.errorMessage,x=f({url:"/api/logout",onConfirm:function(){n(null)}}).post;return Object(s.useEffect)((function(){a&&n(a.user_email)}),[a]),Object(d.jsx)("div",{className:"App",children:Object(d.jsxs)(O.Provider,{value:{loggedInUser:r,setLoggedInUser:n,logout:x},children:[!u&&Object(d.jsx)(p,{loading:j,error:u,errorMessage:m}),!j&&Object(d.jsxs)(c.a,{children:[Object(d.jsx)(z,{}),Object(d.jsxs)(l.d,{children:[Object(d.jsx)(l.b,{exact:!0,path:"/",component:Y}),Object(d.jsx)(l.b,{exact:!0,path:"/login",component:H}),Object(d.jsx)(l.b,{exact:!0,path:"/register",component:W}),Object(d.jsx)(l.b,{path:"/petition_group/",component:function(){return Object(d.jsx)(v,{basePath:"/petition_group/"})}}),Object(d.jsx)(l.b,{exact:!0,path:"/add_petition_group/",component:L}),Object(d.jsx)(l.b,{path:"/add_petition/",component:function(){return Object(d.jsx)(F,{basePath:"/add_petition/"})}}),Object(d.jsx)(l.b,{path:"/petitions/",component:function(){return Object(d.jsx)(D,{basePath:"/petitions/"})}}),Object(d.jsx)(l.b,{exact:!0,path:"/debug/users",component:g})]})]})]})})},Q=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,69)).then((function(t){var r=t.getCLS,s=t.getFID,n=t.getFCP,i=t.getLCP,a=t.getTTFB;r(e),s(e),n(e),i(e),a(e)}))};a.a.render(Object(d.jsx)(n.a.StrictMode,{children:Object(d.jsx)(K,{})}),document.getElementById("root")),Q()}},[[68,1,2]]]);
//# sourceMappingURL=main.be7e07fa.chunk.js.map